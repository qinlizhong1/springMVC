<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd
       http://www.springframework.org/schema/mvc
       http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd">

    <!-- 开启注解扫描,只扫描mvc注解 -->
    <context:component-scan base-package="example" ></context:component-scan>

    <!-- 视图解析器-->
    <bean id="internalResourceViewResolver"
          class="org.springframework.web.servlet.view.InternalResourceViewResolver">

        <property name="prefix" value="/WEB-INF/jsp/"/>

        <property name="suffix" value=".jsp"></property>
    </bean>


     <bean id="dateConvert" class="example.p3.MyConvert"/>
     <bean id="conversionService" class="org.springframework.format.support.FormattingConversionServiceFactoryBean">
         <property name="converters">
             <set>
                 <ref bean="dateConvert"/>
             </set>
         </property>
     </bean>
     <mvc:annotation-driven conversion-service="conversionService"/>

    <!-- 配置拦截器 路径配置中: /* 代表当前一级拦截， 如/test/*会拦截/test/后再跟一级目录的路径。如/test/add /test/del
         /** 代表当前多级拦截   /test/** 则可以拦截 /test/aa/bb/cc等
    -->
    <bean id="myHandlerInterceptor" class="example.p7.MyHandlerInterceptor"></bean>
    <mvc:interceptors>
        <mvc:interceptor>
            <mvc:mapping path="/t7_1"/>
            <ref bean="myHandlerInterceptor"></ref>
        </mvc:interceptor>
    </mvc:interceptors>


    <mvc:interceptors>
        <mvc:interceptor>
            <mvc:mapping path="/add"/>
            <mvc:mapping path="/del"/>
            <bean class="example.p7.login.LoginHandlerInterceptor"></bean>
        </mvc:interceptor>
    </mvc:interceptors>

    <!-- id必须为multipartResolver，不能自定义名称 -->
    <bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
        <!-- 设置编码 -->
        <property name="defaultEncoding" value="utf-8"></property>
        <!-- 每个上传文件大小的最大值 -->
        <property name="maxUploadSizePerFile" value="#{2*1024*1024}"/>
        <!-- 上传文件的总大小的最大值 -->
        <property name="maxUploadSize" value="#{10*1024*1024}"/>
    </bean>
 </beans>